<!DOCTYPE html>
<html>
  <head>
    <title>Playground</title>
    <link href="style.css" rel="stylesheet">
    </style>
  </head>
  <body>
    <form novalidate>
      <label for="angle">Angle</label>
      <input id="angle" type="number" value="90">
      <label for="spread">Spread</label>
      <input id="spread" type="number" value="360">
      <label for="velocity">Start velocity</label>
      <input id="velocity" type="number" value="30">
      <label for="duration">Duration</label>
      <input id="duration" type="number" value="3000">
      <label for="dragFriction">dragFriction</label>
      <input id="dragFriction" type="number" value="0.1">
      <label for="delay">delay</label>
      <input id="delay" type="number" value="1">
      <label for="elements">Elements</label>
      <input id="elements" type="number" value="50">
      <button id="knapp">Knapp</button>
    </form>

    <div id="root">
      <div id="container">
      </div>
    </div>
    <script type="module">
      import { confetti } from '../src/main.js';

      const isElementOnscreen = function(el) {
        var rect = el.getBoundingClientRect();
        const windowBufferPercentage = 0.025
        const heightBuffer = window.innerHeight * windowBufferPercentage;
        const widthBuffer = window.innerWidth * windowBufferPercentage;

        return !(
           (rect.x + rect.width) < widthBuffer
             || (rect.y + rect.height) < heightBuffer
             || (rect.x > window.innerWidth - widthBuffer
             || rect.y > window.innerHeight - heightBuffer)
          );
      }

      function readFormValues() {
        const angle = document.getElementById('angle').value;
        const spread = document.getElementById('spread').value;
        const startVelocity = document.getElementById('velocity').value;
        const duration = parseFloat(document.getElementById('duration').value);
        const dragFriction = parseFloat(document.getElementById('dragFriction').value);
        const delay = parseFloat(document.getElementById('delay').value);
        const elementCount = parseFloat(document.getElementById('elements').value);

        return { angle, spread, startVelocity, duration, dragFriction,delay, elementCount, shouldRenderElement: isElementOnscreen };
      }

      function init() {
        const initialValues = readFormValues();
        const knapp = document.getElementById('knapp');
        const root = document.getElementById('container');
        knapp.addEventListener('click', (e) => {
          const values = readFormValues();
          // values.colors = ['#000','#333', '#666'];
          confetti(root, values);
          e.preventDefault();
        });
        confetti(root, initialValues);
      }

      init();
    </script>
  </body>
</html>
